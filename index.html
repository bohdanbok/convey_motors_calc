<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ConveyMotors Contract Calculator</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="logo.png">
    <link rel="icon" type="image/png" sizes="16x16" href="logo.png">
    <link rel="apple-touch-icon" sizes="180x180" href="logo.png">
    <link rel="shortcut icon" href="logo.png">
    
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/form.css">
    <link rel="stylesheet" href="styles/preview.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="logo-container">
                <img src="logo.png" alt="ConveyMotors Logo" class="logo">
            </div>
            <div class="header-content">
                <h1>ConveyMotors Contract Calculator</h1>
                <p>Fill out the form to generate your contract</p>
            </div>
            <div class="wisdom-branding">
                <img src="Wisdom Logo with black.png" alt="Wisdom Weave Logo" class="wisdom-logo">
                <span class="powered-by">Powered by Wisdom Weave LLC</span>
            </div>
        </header>
        
        <main class="main-content">
            <!-- Left Column - Form -->
            <div class="form-column">
                <form id="contractForm" class="contract-form" novalidate>
                    <!-- Contract Template Selection -->
                    <div class="form-section contract-template-buttons">
                        <h2>Select Your State Template</h2>
                        <div class="template-buttons">
                            <button type="button" class="template-btn" data-template="NJ">
                                <span class="template-state">New Jersey</span>
                                <span class="template-code">NJ</span>
                            </button>
                            <button type="button" class="template-btn" data-template="NY">
                                <span class="template-state">New York</span>
                                <span class="template-code">NY</span>
                            </button>
                            <button type="button" class="template-btn" data-template="PA">
                                <span class="template-state">Pennsylvania</span>
                                <span class="template-code">PA</span>
                            </button>
                        </div>
                        <input type="hidden" id="contract_template" name="contract_template" required>
                    </div>

                    <!-- Personal & Contact Information Section -->
                    <div class="form-section">
                        <h2>Personal & Contact Information</h2>
                        <div class="personal-contact-grid">
                            <!-- Personal Information Column -->
                            <div class="contact-column">
                                <h3>Personal Information</h3>
                                <div class="form-group required">
                                    <label for="full_name">Full Name</label>
                                    <input type="text" id="full_name" name="full_name" required>
                                </div>
                                <div class="form-group required">
                                    <label for="buyer_dob">Date of Birth</label>
                                    <input type="date" id="buyer_dob" name="buyer_dob" required>
                                </div>
                                <div class="form-group required">
                                    <label for="buyer_gender">Gender</label>
                                    <select id="buyer_gender" name="buyer_gender" required>
                                        <option value="">Select Gender</option>
                                        <option value="Male">Male</option>
                                        <option value="Female">Female</option>
                                        <option value="Other">Other</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="buyer_eye">Eye Color</label>
                                    <input type="text" id="buyer_eye" name="buyer_eye">
                                </div>
                                <div class="form-group required">
                                    <label for="buyer_license">Driver License</label>
                                    <input type="text" id="buyer_license" name="buyer_license" required>
                                </div>
                            </div>
                            
                            <!-- Address Information Column -->
                            <div class="contact-column">
                                <h3>Address Information</h3>
                                <div class="form-group required">
                                    <label for="buyer_address">Address</label>
                                    <input type="text" id="buyer_address" name="buyer_address" required>
                                </div>
                                <div class="form-group required">
                                    <label for="buyer_city">City</label>
                                    <input type="text" id="buyer_city" name="buyer_city" required>
                                </div>
                                <div class="form-group required">
                                    <label for="buyer_state">State</label>
                                    <select id="buyer_state" name="buyer_state" required>
                                        <option value="">Select State</option>
                                        <option value="AL">Alabama</option>
                                        <option value="AK">Alaska</option>
                                        <option value="AZ">Arizona</option>
                                        <option value="AR">Arkansas</option>
                                        <option value="CA">California</option>
                                        <option value="CO">Colorado</option>
                                        <option value="CT">Connecticut</option>
                                        <option value="DE">Delaware</option>
                                        <option value="DC">District of Columbia</option>
                                        <option value="FL">Florida</option>
                                        <option value="GA">Georgia</option>
                                        <option value="HI">Hawaii</option>
                                        <option value="ID">Idaho</option>
                                        <option value="IL">Illinois</option>
                                        <option value="IN">Indiana</option>
                                        <option value="IA">Iowa</option>
                                        <option value="KS">Kansas</option>
                                        <option value="KY">Kentucky</option>
                                        <option value="LA">Louisiana</option>
                                        <option value="ME">Maine</option>
                                        <option value="MD">Maryland</option>
                                        <option value="MA">Massachusetts</option>
                                        <option value="MI">Michigan</option>
                                        <option value="MN">Minnesota</option>
                                        <option value="MS">Mississippi</option>
                                        <option value="MO">Missouri</option>
                                        <option value="MT">Montana</option>
                                        <option value="NE">Nebraska</option>
                                        <option value="NV">Nevada</option>
                                        <option value="NH">New Hampshire</option>
                                        <option value="NJ">New Jersey</option>
                                        <option value="NM">New Mexico</option>
                                        <option value="NY">New York</option>
                                        <option value="NC">North Carolina</option>
                                        <option value="ND">North Dakota</option>
                                        <option value="OH">Ohio</option>
                                        <option value="OK">Oklahoma</option>
                                        <option value="OR">Oregon</option>
                                        <option value="PA">Pennsylvania</option>
                                        <option value="RI">Rhode Island</option>
                                        <option value="SC">South Carolina</option>
                                        <option value="SD">South Dakota</option>
                                        <option value="TN">Tennessee</option>
                                        <option value="TX">Texas</option>
                                        <option value="UT">Utah</option>
                                        <option value="VT">Vermont</option>
                                        <option value="VA">Virginia</option>
                                        <option value="WA">Washington</option>
                                        <option value="WV">West Virginia</option>
                                        <option value="WI">Wisconsin</option>
                                        <option value="WY">Wyoming</option>
                                    </select>
                                </div>
                                <div class="form-group required">
                                    <label for="buyer_zip">ZIP Code</label>
                                    <input type="text" id="buyer_zip" name="buyer_zip" required>
                                </div>
                            </div>
                            
                            <!-- Phone Information Column -->
                            <div class="contact-column">
                                <h3>Phone Information</h3>
                                <div class="form-group required">
                                    <label for="buyer_cellphone">Cell Phone</label>
                                    <input type="tel" id="buyer_cellphone" name="buyer_cellphone" inputmode="tel" title="Enter 10 digits" required>
                                </div>
                                <div class="form-group">
                                    <label for="buyer_residencephone">Residence Phone</label>
                                    <input type="tel" id="buyer_residencephone" name="buyer_residencephone" inputmode="tel" title="Enter 10 digits">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Vehicle Information Section -->
                    <div class="form-section">
                        <h2>Vehicle Information</h2>
                        <div class="vehicle-info-grid">
                            <!-- Basic Vehicle Info Column -->
                            <div class="vehicle-column">
                                <h3>Basic Vehicle Info</h3>
                                <div class="form-group required">
                                    <label for="car_year">Year</label>
                                    <input type="text" id="car_year" name="car_year" pattern="^(19|20)\d{2}$" placeholder="YYYY" required>
                                </div>
                                <div class="form-group required">
                                    <label for="car_make">Make</label>
                                    <input type="text" id="car_make" name="car_make" required>
                                </div>
                                <div class="form-group required">
                                    <label for="car_model">Model</label>
                                    <input type="text" id="car_model" name="car_model" required>
                                </div>
                            </div>
                            
                            <!-- Vehicle Details Column -->
                            <div class="vehicle-column">
                                <h3>Vehicle Details</h3>
                                <div class="form-group">
                                    <label for="car_body">Body Style</label>
                                    <input type="text" id="car_body" name="car_body">
                                </div>
                                <div class="form-group">
                                    <label for="car_color">Color</label>
                                    <input type="text" id="car_color" name="car_color">
                                </div>
                                <div class="form-group required">
                                    <label for="car_miles">Mileage</label>
                                    <input type="number" id="car_miles" name="car_miles" min="0" required>
                                </div>
                            </div>
                            
                            <!-- Vehicle Identification Column -->
                            <div class="vehicle-column">
                                <h3>Vehicle Identification</h3>
                                <div class="form-group required">
                                    <label for="car_vin">VIN</label>
                                    <input type="text" id="car_vin" name="car_vin" autocomplete="off" maxlength="17" title="17-character VIN" required>
                                </div>
                                <div class="form-group required">
                                    <label for="car_price">Car Price</label>
                                    <input type="text" id="car_price" name="car_price" pattern="^\d+(\.\d{1,2})?$" placeholder="0.00" required>
                                </div>
                                <div class="form-group required">
                                    <label for="dealer_stock">Dealer Stock</label>
                                    <input type="text" id="dealer_stock" name="dealer_stock" autocomplete="off" required>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Warranty Selection -->
                    <div class="form-section">
                        <h2>Warranty</h2>
                        <div class="template-buttons">
                            <button type="button" class="template-btn warranty-btn" data-warranty="AS_IS">
                                <span class="template-state">No Warranty</span>
                            </button>
                            <button type="button" class="template-btn warranty-btn" data-warranty="WARRANTY">
                                <span class="template-state">Warranty</span>
                            </button>
                        </div>
                        <input type="hidden" id="warranty_type" name="warranty_type" required>
                    </div>

                    <!-- Financial Information Section -->
                    <div class="form-section">
                        <h2>Financial Information</h2>
                        <div class="financial-info-grid">
                            <!-- Accessories Column -->
                            <div class="financial-column">
                                <h3>Accessories</h3>
                                <div class="accessories-table-header">
                                    <div class="header-name">Accessories Name</div>
                                    <div class="header-amount">Amount</div>
                                </div>
                                <div class="dynamic-fields-container" id="accessories-container">
                                    <!-- Dynamic accessories will be added here -->
                                </div>
                                <div class="add-field-section">
                                    <button type="button" class="add-field-btn" data-container="accessories" data-max="4">
                                        <span class="add-icon">+</span>
                                        <span class="add-text">Add Accessory</span>
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Service Fee Column -->
                            <div class="financial-column">
                                <h3>Service Fee</h3>
                                <div class="services-table-header">
                                    <div class="header-name">Services Name</div>
                                    <div class="header-amount">Amount</div>
                                </div>
                                <div class="dynamic-fields-container" id="services-container">
                                    <div class="dynamic-field-group locked-service-group">
                                        <div class="form-group field-name">
                                            <input type="text" id="docfee_price" name="docfee_price" value="Documentation Fee" readonly>
                                        </div>
                                        <div class="form-group field-amount locked-field">
                                            <div class="locked-input-container">
                                                <input type="number" id="docfee_amount" name="docfee_amount" min="0" step="0.01" value="799" readonly>
                                                <button type="button" class="lock-btn" data-field="docfee_amount" data-default="799">
                                                    <span class="lock-icon">🔒</span>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="dynamic-field-group locked-service-group">
                                        <div class="form-group field-name">
                                            <input type="text" id="lo_jack" name="lo_jack" value="LoJack Fee" readonly>
                                        </div>
                                        <div class="form-group field-amount locked-field">
                                            <div class="locked-input-container">
                                                <input type="number" id="lo_jack_amount" name="lo_jack_amount" min="0" step="0.01" value="1495" readonly>
                                                <button type="button" class="lock-btn" data-field="lo_jack_amount" data-default="1495">
                                                    <span class="lock-icon">🔒</span>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="add-field-section">
                                    <button type="button" class="add-field-btn" data-container="services" data-max="4">
                                        <span class="add-icon">+</span>
                                        <span class="add-text">Add Service</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Down Payment Field -->
                        <div class="down-payment-section">
                            <div class="form-group">
                                <label for="down_payment">Down Payment</label>
                                <input type="text" id="down_payment" name="down_payment" pattern="^\d+(\.\d{1,2})?$" placeholder="0.00">
                            </div>
                        </div>
                        
                        <!-- Tax Information -->
                        <div class="tax-info-section" id="tax_info_section" style="display: block;">
                            <h3>Tax Information</h3>
                            <div class="tax-field-container">
                                <div class="tax-label">Sales Tax</div>
                                <div class="form-group locked-field">
                                    <label for="salestax_price">Rate - %</label>
                                    <div class="locked-input-container">
                                        <input type="number" id="salestax_price" name="salestax_price" min="0" step="0.001" value="6.625" readonly>
                                        <button type="button" class="lock-btn" data-field="salestax_price" data-default="6.625">
                                            <span class="lock-icon">🔒</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Lien Information Section -->
                    <div class="form-section">
                        <h2>Lien Information</h2>
                        <div class="form-group">
                            <label for="lien_type">Lien Type</label>
                            <select id="lien_type" name="lien_type">
                                <option value="cash" selected>Cash</option>
                                <option value="credit_acceptance">Credit Acceptance Corp.</option>
                                <option value="westlake">Westlake Financial Services</option>
                                <option value="western_funding">Western Funding</option>
                            </select>
                        </div>
                        <div id="lien_fields" class="lien-fields" style="display: none;">
                            <div class="form-grid">
                                <div class="form-group required">
                                    <label for="lien_name">Lien Holder Name</label>
                                    <input type="text" id="lien_name" name="lien_name" readonly>
                                </div>
                                <div class="form-group required">
                                    <label for="lien_address">Lien Holder Address</label>
                                    <input type="text" id="lien_address" name="lien_address" readonly>
                                </div>
                                <div class="form-group required">
                                    <label for="lien_city">Lien Holder City</label>
                                    <input type="text" id="lien_city" name="lien_city" readonly>
                                </div>
                                <div class="form-group required">
                                    <label for="lien_state">Lien Holder State</label>
                                    <input type="text" id="lien_state" name="lien_state" readonly>
                                </div>
                                <div class="form-group required">
                                    <label for="lien_zip">Lien Holder ZIP</label>
                                    <input type="text" id="lien_zip" name="lien_zip" readonly>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Additional Information Section -->
                    <div class="form-section">
                        <h2>Additional Information</h2>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="sales_person">Sales Person</label>
                                <input type="text" id="sales_person" name="sales_person">
                            </div>
                            <div class="form-group">
                                <label for="date_value">Contract Date</label>
                                <input type="date" id="date_value" name="date_value">
                            </div>
                        </div>
                    </div>

                    

                    <!-- Trade-in Toggle Section -->
                    <div class="form-section">
                        <div class="toggle-section">
                            <div class="toggle-header">
                                <h2>Trade-in Information</h2>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="tradein_toggle" name="tradein_toggle">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                            <div id="tradein_section" class="tradein-section" style="display: none;">
                                <div class="form-grid">
                                    <div class="form-group required">
                                        <label for="tradein_year">Trade-in Year</label>
                                        <input type="text" id="tradein_year" name="tradein_year" pattern="^(19|20)\d{2}$" placeholder="YYYY">
                                    </div>
                                    <div class="form-group required">
                                        <label for="tradein_make">Trade-in Make</label>
                                        <input type="text" id="tradein_make" name="tradein_make">
                                    </div>
                                    <div class="form-group required">
                                        <label for="tradein_model">Trade-in Model</label>
                                        <input type="text" id="tradein_model" name="tradein_model">
                                    </div>
                                    <div class="form-group required">
                                        <label for="tradein_price">Trade-in Value</label>
                                        <input type="text" id="tradein_price" name="tradein_price" pattern="^\d+(\.\d{1,2})?$" placeholder="0.00">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Co-Buyer Toggle Section -->
                    <div class="form-section">
                        <div class="toggle-section">
                            <div class="toggle-header">
                                <h2>Co-Buyer Information</h2>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="cobuyer_toggle" name="cobuyer_toggle">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                            <div id="cobuyer_section" class="cobuyer-section" style="display: none;">
                                <div class="personal-contact-grid">
                                    <!-- Personal Information Column -->
                                    <div class="contact-column">
                                        <h3>Personal Information</h3>
                                        <div class="form-group required">
                                            <label for="cobuyerfull_name">Co-buyer Full Name</label>
                                            <input type="text" id="cobuyerfull_name" name="cobuyerfull_name">
                                        </div>
                                        <div class="form-group required">
                                            <label for="cobuyer_dob">Co-buyer Date of Birth</label>
                                            <input type="date" id="cobuyer_dob" name="cobuyer_dob">
                                        </div>
                                        <div class="form-group required">
                                            <label for="cobuyer_gender">Co-buyer Gender</label>
                                            <select id="cobuyer_gender" name="cobuyer_gender">
                                                <option value="">Select Gender</option>
                                                <option value="Male">Male</option>
                                                <option value="Female">Female</option>
                                                <option value="Other">Other</option>
                                            </select>
                                        </div>
                                        <div class="form-group required">
                                            <label for="cobuyer_license">Co-buyer Driver License</label>
                                            <input type="text" id="cobuyer_license" name="cobuyer_license">
                                        </div>
                                    </div>
                                    
                                    <!-- Address Information Column -->
                                    <div class="contact-column">
                                        <h3>Address Information</h3>
                                        <div class="form-group required">
                                            <label for="cobuyer_address">Co-buyer Address</label>
                                            <input type="text" id="cobuyer_address" name="cobuyer_address">
                                        </div>
                                        <div class="form-group required">
                                            <label for="cobuyer_city">Co-buyer City</label>
                                            <input type="text" id="cobuyer_city" name="cobuyer_city">
                                        </div>
                                        <div class="form-group required">
                                            <label for="cobuyer_state">Co-buyer State</label>
                                            <select id="cobuyer_state" name="cobuyer_state">
                                                <option value="">Select State</option>
                                                <option value="AL">Alabama</option>
                                                <option value="AK">Alaska</option>
                                                <option value="AZ">Arizona</option>
                                                <option value="AR">Arkansas</option>
                                                <option value="CA">California</option>
                                                <option value="CO">Colorado</option>
                                                <option value="CT">Connecticut</option>
                                                <option value="DE">Delaware</option>
                                                <option value="DC">District of Columbia</option>
                                                <option value="FL">Florida</option>
                                                <option value="GA">Georgia</option>
                                                <option value="HI">Hawaii</option>
                                                <option value="ID">Idaho</option>
                                                <option value="IL">Illinois</option>
                                                <option value="IN">Indiana</option>
                                                <option value="IA">Iowa</option>
                                                <option value="KS">Kansas</option>
                                                <option value="KY">Kentucky</option>
                                                <option value="LA">Louisiana</option>
                                                <option value="ME">Maine</option>
                                                <option value="MD">Maryland</option>
                                                <option value="MA">Massachusetts</option>
                                                <option value="MI">Michigan</option>
                                                <option value="MN">Minnesota</option>
                                                <option value="MS">Mississippi</option>
                                                <option value="MO">Missouri</option>
                                                <option value="MT">Montana</option>
                                                <option value="NE">Nebraska</option>
                                                <option value="NV">Nevada</option>
                                                <option value="NH">New Hampshire</option>
                                                <option value="NJ">New Jersey</option>
                                                <option value="NM">New Mexico</option>
                                                <option value="NY">New York</option>
                                                <option value="NC">North Carolina</option>
                                                <option value="ND">North Dakota</option>
                                                <option value="OH">Ohio</option>
                                                <option value="OK">Oklahoma</option>
                                                <option value="OR">Oregon</option>
                                                <option value="PA">Pennsylvania</option>
                                                <option value="RI">Rhode Island</option>
                                                <option value="SC">South Carolina</option>
                                                <option value="SD">South Dakota</option>
                                                <option value="TN">Tennessee</option>
                                                <option value="TX">Texas</option>
                                                <option value="UT">Utah</option>
                                                <option value="VT">Vermont</option>
                                                <option value="VA">Virginia</option>
                                                <option value="WA">Washington</option>
                                                <option value="WV">West Virginia</option>
                                                <option value="WI">Wisconsin</option>
                                                <option value="WY">Wyoming</option>
                                            </select>
                                        </div>
                                        <div class="form-group required">
                                            <label for="cobuyer_zip">Co-buyer ZIP Code</label>
                                            <input type="text" id="cobuyer_zip" name="cobuyer_zip">
                                        </div>
                                    </div>
                                    
                                    <!-- Phone Information Column -->
                                    <div class="contact-column">
                                        <h3>Phone Information</h3>
                                        <div class="form-group required">
                                            <label for="cobuyer_cellphone">Co-buyer Cell Phone</label>
                                            <input type="tel" id="cobuyer_cellphone" name="cobuyer_cellphone" inputmode="tel" title="Enter 10 digits">
                                        </div>
                                        <div class="form-group">
                                            <label for="cobuyer_residencephone">Co-buyer Residence Phone</label>
                                            <input type="tel" id="cobuyer_residencephone" name="cobuyer_residencephone" inputmode="tel" title="Enter 10 digits">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>



                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">Generate Contract</button>
                    </div>
                </form>
            </div>

            <!-- Right Column - Preview -->
            <div class="preview-column">
                <div class="preview-header">
                    <h2>Contract Preview</h2>
                    <p>Real-time preview of your contract data</p>
                </div>
                <div id="contractPreview" class="contract-preview">
                    <div class="preview-placeholder">
                        <p>Fill out the form to see the preview</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmationModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>⚠️ Warning</h3>
            </div>
            <div class="modal-body">
                <p>Are you sure that you want to change this data?</p>
                <p class="modal-note">This information is displayed on the website and affects contract calculations.</p>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn btn-secondary" id="modalCancel">Cancel</button>
                <button type="button" class="btn btn-primary" id="modalConfirm">Yes, I know</button>
            </div>
        </div>
    </div>

    <!-- Loading Modal -->
    <div id="loadingModal" class="modal">
        <div class="modal-content loading-content">
            <h3>🔄 Generating Contract</h3>
            <p>Please wait while we generate your contract...</p>
            <div class="progress-bar">
                <div class="progress-fill"></div>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="successModal" class="modal">
        <div class="modal-content success-content">
            <div class="success-icon">✅</div>
            <h3>Contract Generated Successfully!</h3>
            <p>Your contract has been generated and sent. The form has been cleared and is ready for the next use.</p>
            <button id="successOk" class="btn btn-primary">Continue</button>
        </div>
    </div>

    <script src="config.js"></script>
    <script src="js/calculator.js"></script>
    <script src="js/preview.js"></script>
    <script src="js/form-handler.js"></script>
</body>
</html> 